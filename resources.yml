Description: Network Allocator Resources
Parameters:
  CodeBucket:
    Description: S3 bucket name for ZIP bundle
    Type: String
  CodeKey:
    Description: S3 path of ZIP bundle
    Type: String
Resources:
  APIHandler:
    Properties:
      CodeUri:
        Bucket: !Ref 'CodeBucket'
        Key: !Ref 'CodeKey'
      Environment:
        Variables:
          NETWORK_TABLE: !Ref 'NetworkTable'
    Type: AWS::Serverless::Function
  NetworkTable:
    Properties:
      AttributeDefinitions:
        - AttributeName: network_integer
          AttributeType: N
        - AttributeName: prefix_length
          AttributeType: N
      BillingMode: PAY_PER_REQUEST
      KeySchema:
        - AttributeName: network_integer
          KeyType: HASH
        - AttributeName: prefix_length
          KeyType: RANGE
      TableName: network_table
    Type: AWS::DynamoDB::Table

